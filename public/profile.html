<!doctype html>
<html><head><meta charset="utf-8"><title>Profile</title><meta name="viewport" content="width=device-width,initial-scale=1"><link href="/style.css" rel="stylesheet"></head><body>
<div class="container"><div class="header"><div class="logo">Profile</div><div class="user"></div></div>
<div id="profile"></div>
</div>
<script src="/app.js"></script>
<script>
async function load(){ const params = new URLSearchParams(location.search); const username = params.get('user'); if(!username){ document.getElementById('profile').innerHTML = '<div class="card muted">No user specified</div>'; return; }
 try{ const r = await getJSON('/api/user/'+encodeURIComponent(username)); if(!r.ok){ document.getElementById('profile').innerHTML = '<div class="card muted">User not found</div>'; return; } const j = await r.json(); const badgesHTML = (j.badges && j.badges.length) ? '<div style="margin-top:8px">'+ j.badges.map(b=>`<span style="padding:6px 8px;margin-right:6px;border-radius:999px;background:#f1f5f9;font-weight:600">${b}</span>`).join('') +'</div>' : ''; document.getElementById('profile').innerHTML = `<div class="card"><div style="display:flex;gap:12px;align-items:center"><div class="avatar">${(j.username||'U').charAt(0).toUpperCase()}</div><div><div style="font-weight:700">${j.username}</div><div class="small muted">${j.reputation||0} pts â€¢ ${j.followerCount||0} followers</div></div></div>${badgesHTML}<div style="margin-top:10px">${(j.favoriteClub?'<div class="small">Club: '+j.favoriteClub+'</div>':'')}</div><div style="margin-top:12px"><button id="followBtn" class="btn">Follow</button></div></div>`; updateHeader(); attach(j.id); }catch(e){ document.getElementById('profile').textContent='error'} }
async function attach(targetId){ const btn = document.getElementById('followBtn'); if(!btn) return; btn.addEventListener('click', async ()=>{ try{ const rr = await fetch('/api/user/'+encodeURIComponent(targetId)+'/follow', { method: 'POST', headers: { Authorization: localStorage.getItem('token') } }); if(rr.ok){ const j=await rr.json(); alert(j.following? 'followed':'unfollowed'); } else alert('login required or error'); }catch(e){alert('error')} }); }
load();
</script>
</body></html>